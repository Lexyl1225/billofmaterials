<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill of Materials</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
            font-size: 11px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .header-section {
            margin-bottom: 20px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }

        .header-section div {
            margin: 3px 0;
        }

        .header-section strong {
            text-decoration: underline;
        }

        .perimeter-section {
            margin-bottom: 10px;
            font-weight: bold;
        }
        .header {
            text-align: center;
        }
        .project-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 13px;
        }
        .section-title {
            background-color: #FFFF00;
            font-weight: bold;
            padding: 6px 10px;
            margin-top: 10px;
            margin-bottom: 0;
            border: 1px solid #000;
            font-size: 11px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 11px;
        }

        table thead {
            background-color: #FFFF00;
            font-weight: bold;
        }

        table th, table td {
            border: 1px solid #000;
            padding: 5px 8px;
            text-align: left;
        }

        table th {
            text-align: center;
            background-color: #FFFF00;
            font-size: 10px;
        }

        .total-row {
            background-color: #FFFF00;
            font-weight: bold;
        }

        .total-row td {
            background-color: #FFFF00;
        }

        .signatures {
            margin-top: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            font-size: 10px;
        }

        .signature-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .signature-block {
            text-align: center;
        }

        .signature-label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .signature-line {
            border-top: 1px solid #000;
            margin-top: 40px;
            padding-top: 3px;
        }

        .signature-name {
            font-weight: bold;
            margin-top: 3px;
        }

        .signature-title {
            font-size: 9px;
            margin-top: 2px;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 2px;
            border: none;
            background-color: transparent;
            font-size: 11px;
        }

        input[type="number"] {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .description-input {
            width: 100%;
            padding: 3px;
            border: none;
            background-color: transparent;
            font-size: 11px;
            cursor: pointer;
            resize: none;
            overflow: hidden;
            min-height: 20px;
            line-height: 1.3;
            font-family: Arial, sans-serif;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .material-dropdown {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .material-dropdown div {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 11px;
        }

        .material-dropdown div:hover {
            background-color: #FFFF00;
        }

        .unit-input, .qty-input, .unit-cost-input {
            width: 100%;
            height: 100%;
            padding: 3px;
            border: none;
            background-color: transparent;
            font-size: 11px;
            text-align: center;
            box-sizing: border-box;
        }

        .unit-input {
            cursor: pointer;
        }

        .unit-dropdown {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .unit-dropdown div {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 11px;
        }

        .unit-dropdown div:hover {
            background-color: #FFFF00;
        }

        button {
            padding: 10px 20px;
            margin: 0 5px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #666;
            background-color: #e8e8e8;
        }

        button:hover {
            background-color: #d0d0d0;
        }

        .add-row-btn {
            background-color: #FFFF00;
            font-weight: bold;
            margin-top: 5px;
            margin-right: 5px;
            padding: 10px 15px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #666;
        }

        .remove-row-btn {
            background-color: #ff6b6b;
            color: white;
            font-weight: bold;
            padding: 10px 15px;
            margin-top: 5px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #666;
        }

        .delete-section-btn {
            background-color: #cc0000;
            color: white;
            font-weight: bold;
            padding: 10px 15px;
            margin-top: 5px;
            margin-left: 10px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #666;
        }

        .add-section-btn {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
            padding: 10px 15px;
            margin-top: 5px;
            margin-left: 5px;
            font-size: 13px;
            cursor: pointer;
            border: 1px solid #666;
            position: relative;
        }

        .section-btn-container {
            position: relative;
            display: inline-block;
        }

        .section-dropdown {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            background-color: white;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            box-shadow: 0 -4px 8px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 280px;
            margin-bottom: 5px;
        }

        .section-dropdown.show {
            display: block;
        }

        .section-dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }

        .section-dropdown-item:last-child {
            border-bottom: none;
        }

        .section-dropdown-item:hover {
            background-color: #4CAF50;
            color: white;
        }

        .button-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        .button-group button {
            padding: 12px 30px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid #333;
            border-radius: 5px;
        }

        .print-btn {
            background-color: #2196F3;
            color: white;
        }

        .print-btn:hover {
            background-color: #1976D2;
        }

        .clear-btn {
            background-color: #ff9800;
            color: white;
        }

        .clear-btn:hover {
            background-color: #f57c00;
        }

        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                max-width: 100%;
                padding: 20px;
            }
            button, .button-group, .add-row-btn, .remove-row-btn, .delete-section-btn, .add-section-btn, .section-btn-container {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
          <!-- Header -->
        <div class="header">
            <hr style="border: 1.5px solid #ffd102; width: 100%; margin: 0 auto 15px auto;">

            <h2>BILL OF MATERIALS</h2><br>
         
            <hr style="border: 1.5px solid #ffd102; width: 100%; margin: 0 auto 15px auto;">
        


        </div>

        <!-- Project Information -->
        <div class="project-info">
            <div class="info-group">
                <label>Department:</label>
                <input type="text" id="projectName" placeholder="Enter Department Name">
            </div>
            <div class="info-group">
                <label>Project Name:</label>
                <input type="text" id="projectName" placeholder="Enter project name">
            </div>
            <div class="info-group">
                <label>Location:</label>
                <input type="text" id="projectLocation" placeholder="Enter location">
            </div>
            <div class="info-group">
                <label>Total Floor Area:</label>
                <input type="text" id="projectName" placeholder="Enter total floor area">
            </div>
            <div class="info-group">
                <label>Date:</label>
                <input type="date" id="dateField">
            </div>
            <div class="info-group">
                <label>Reference no:</label>
                <input type="text" id="referenceNo" readonly>
            </div>
        </div>
        
 
        <script>
        // Auto-generate Reference No in format MCE-yyyymonthdaytime
        function pad(n) { return n < 10 ? '0' + n : n; }
        function generateReferenceNo() {
            var now = new Date();
            var yyyy = now.getFullYear();
            var mm = pad(now.getMonth() + 1);
            var dd = pad(now.getDate());
            var hh = pad(now.getHours());
            var min = pad(now.getMinutes());
            var ss = pad(now.getSeconds());
            var ref = `MCE-${yyyy}${mm}${dd}${hh}${min}${ss}`;
            document.getElementById('referenceNo').value = ref;
        }
        window.addEventListener('DOMContentLoaded', generateReferenceNo);
        </script>

               <!-- Bill of Materials -->
        <div style="font-weight: bold; margin-bottom: 10px;">MATERIALS COST ESTIMATE: BILL OF MATERIALS SECTION</div>

        <!-- Panel Board and Circuit Breakers -->
        <div id="panelSection" class="bom-section">
        <div class="section-title">PANEL BOARD AND CIRCUIT BREAKERS:</div>
        <table id="panelTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="panel" rows="1">Main 1-30A G.E. TYPE, 60Hz, Bolt-on Type,With Safety ENCLOSURE</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="1,600.00"></td>
                    <td class="text-right total-cost">1,600.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="panel" rows="1">Main 1-20A G.E. TYPE, 60Hz, Bolt-on Type,With Safety ENCLOSURE</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="1,200.00"></td>
                    <td class="text-right total-cost">1,200.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="panel" rows="1">Main 1-20A G.E. TYPE, 60Hz, Bolt-on Type,With Safety ENCLOSURE</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="2"></td>
                    <td><input type="text" class="unit-cost-input" value="1,200.00"></td>
                    <td class="text-right total-cost">2,400.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('panelTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('panelTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('panelSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('panelSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

        <!-- Wires and Cables -->
        <div id="wiresSection" class="bom-section">
        <div class="section-title">WIRES AND CABLES:</div>
        <table id="wiresTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="wires" rows="1">3.5 sq. mm. THHN, Phelps Dodge</textarea></td>
                    <td><input type="text" class="unit-input" value="box"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="5,800.00"></td>
                    <td class="text-right total-cost">5,800.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="wires" rows="1">White</textarea></td>
                    <td><input type="text" class="unit-input" value="box"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="5,800.00"></td>
                    <td class="text-right total-cost">5,800.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('wiresTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('wiresTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('wiresSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('wiresSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

    <!-- Lighting Fixtures -->
        <div id="lightingSection" class="bom-section">
        <div class="section-title">LIGHTING FIXTURES:</div>
        <table id="lightingFixturesTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="lightingFixtures" rows="1">3.5 sq. mm. THHN, Phelps Dodge</textarea></td>
                    <td><input type="text" class="unit-input" value="box"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="5,800.00"></td>
                    <td class="text-right total-cost">5,800.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="lightingFixtures" rows="1">White</textarea></td>
                    <td><input type="text" class="unit-input" value="box"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="5,800.00"></td>
                    <td class="text-right total-cost">5,800.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('lightingFixturesTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('lightingFixturesTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('lightingSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('lightingSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

        <!-- Convenience Outlet and Switches -->
        <div id="outletsSection" class="bom-section">
        <div class="section-title">CONVENIENCE OUTLET AND SWITCHES:</div>
        <table id="outletsTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="outlets" rows="1">GROUNDING DUPLEX, UNIVERSAL OUTLET w/ safety shutter 1-5, 250V VAC, 15AMP, NEMA 5-20R, PANASONIC, Sky Silv</textarea></td>
                    <td><input type="text" class="unit-input" value="sets"></td>
                    <td><input type="number" class="qty-input" value="35"></td>
                    <td><input type="text" class="unit-cost-input" value="240.00"></td>
                    <td class="text-right total-cost">8,400.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="outlets" rows="1">Utility Box</textarea></td>
                    <td><input type="text" class="unit-input" value="set"></td>
                    <td><input type="number" class="qty-input" value="35"></td>
                    <td><input type="text" class="unit-cost-input" value="30.00"></td>
                    <td class="text-right total-cost">1,050.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="outlets" rows="1">Junction Box</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="7"></td>
                    <td><input type="text" class="unit-cost-input" value="100.00"></td>
                    <td class="text-right total-cost">700.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('outletsTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('outletsTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('outletsSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('outletsSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

        <!-- Conduit and Fittings -->
        <div id="conduitSection" class="bom-section">
        <div class="section-title">CONDUIT AND FITTINGS:</div>
        <table id="conduitTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="conduit" rows="1">15mm diam. Emt Pipe</textarea></td>
                    <td><input type="text" class="unit-input" value="pc"></td>
                    <td><input type="number" class="qty-input" value="35"></td>
                    <td><input type="text" class="unit-cost-input" value="240.00"></td>
                    <td class="text-right total-cost">8,400.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="conduit" rows="1">20mm diam. Emt Pipe</textarea></td>
                    <td><input type="text" class="unit-input" value="pc"></td>
                    <td><input type="number" class="qty-input" value="35"></td>
                    <td><input type="text" class="unit-cost-input" value="30.00"></td>
                    <td class="text-right total-cost">1,050.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="conduit" rows="1">25mm diam. Emt Pipe</textarea></td>
                    <td><input type="text" class="unit-input" value="pc"></td>
                    <td><input type="number" class="qty-input" value="7"></td>
                    <td><input type="text" class="unit-cost-input" value="100.00"></td>
                    <td class="text-right total-cost">700.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('conduitTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('conduitTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('conduitSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('conduitSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

        <!-- Miscellaneous -->
        <div id="miscSection" class="bom-section">
        <div class="section-title">MISCELLANEOUS:</div>
        <table id="miscTable">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Electrical Tape</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="6"></td>
                    <td><input type="text" class="unit-cost-input" value="50.00"></td>
                    <td class="text-right total-cost">300.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Rubber Molding</textarea></td>
                    <td><input type="text" class="unit-input" value="box"></td>
                    <td><input type="number" class="qty-input" value="2"></td>
                    <td><input type="text" class="unit-cost-input" value="5,000.00"></td>
                    <td class="text-right total-cost">10,000.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Electrical Fixtures circuit at 1/2-10am</textarea></td>
                    <td><input type="text" class="unit-input" value="pc"></td>
                    <td><input type="number" class="qty-input" value="1"></td>
                    <td><input type="text" class="unit-cost-input" value="200.00"></td>
                    <td class="text-right total-cost">200.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Flexible hose connector clamp 1/2</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="80"></td>
                    <td><input type="text" class="unit-cost-input" value="15.00"></td>
                    <td class="text-right total-cost">1,200.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Duct Tape</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="5"></td>
                    <td><input type="text" class="unit-cost-input" value="200.00"></td>
                    <td class="text-right total-cost">1,000.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Warning Tape</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="10"></td>
                    <td><input type="text" class="unit-cost-input" value="250.00"></td>
                    <td class="text-right total-cost">2,500.00</td>
                </tr>
                <tr>
                    <td><textarea class="description-input" data-section="misc" rows="1">Cloth Tape</textarea></td>
                    <td><input type="text" class="unit-input" value="pcs"></td>
                    <td><input type="number" class="qty-input" value="5"></td>
                    <td><input type="text" class="unit-cost-input" value="250.00"></td>
                    <td class="text-right total-cost">1,250.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('miscTable')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('miscTable')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('miscSection')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('miscSection', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>

        <!-- Total Row -->
        <table style="margin-top: 15px;">
            <tr class="total-row">
                <td colspan="3" style="text-align: center; font-weight: bold;">TOTAL ESTIMATED COSTS:</td>
                <td style="text-align: center; font-weight: bold;">TOTAL</td>
                <td id="grandTotal" style="text-align: right; font-weight: bold;">0.00</td>
            </tr>
        </table>

        <!-- Signatures -->
        <div class="signatures">
            <div class="signature-row">
                <div class="signature-block">
                    <div class="signature-label">PREPARED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="prepared_name" value="Danilo Pascua" /></div>
                    <div class="signature-title"><input type="text" name="prepared_position" placeholder="Position" /></div>
                </div>
                <div class="signature-block">
                    <div class="signature-label">CHECKED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="checked_name" value="Kimberly Onin" /></div>
                    <div class="signature-title"><input type="text" name="checked_position" value="Accounting Department" /></div>
                </div>
            </div>
            <div class="signature-row">
                <div class="signature-block">
                    <div class="signature-label">CHECKED AND APPROVED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="checked_approved_name" value="Edison Sing" /></div>
                    <div class="signature-title"><input type="text" name="checked_approved_position" value="Logistics/Warehouse Dept. Head" /></div>
                </div>
                <div class="signature-block">
                    <div class="signature-label">CHECKED AND APPROVED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="checked_approved_name2" value="Ryan Caguioa" /></div>
                    <div class="signature-title"><input type="text" name="checked_approved_position2" value="DAC Department HEAD" /></div>
                </div>
            </div>
            <div class="signature-row">
                <div class="signature-block">
                    <div class="signature-label">NOTED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="noted_name" value="Alexander Fernandez" /></div>
                    <div class="signature-title"><input type="text" name="noted_position" value="Elerctrical Engineer" /></div>
                </div>
                <div class="signature-block">
                    <div class="signature-label">APPROVED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="approved2_name" value="Ronal Lopez" /></div>
                    <div class="signature-title"><input type="text" name="approved2_position" value="Devision HEAD" /></div>
                </div>
            </div>
            <div class="signature-row">
                <div class="signature-block">
                    <div class="signature-label">APPROVED BY:</div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="approved3_name" value="Racquel De Lara" /></div>
                    <div class="signature-title"><input type="text" name="approved3_position" value="AVP-OPERATIONS NVI/B" /></div>
                </div>
                <div class="signature-block">
                    <div class="signature-label">APPROVED BY:</div>
                    <div style="font-weight: bold; margin-bottom: 5px;"></div>
                    <div class="signature-line"></div>
                    <div class="signature-name"><input type="text" name="approved4_name" value="Oliver Ryan Co" /></div>
                    <div class="signature-title"><input type="text" name="approved4_position" value="VP-Corporate Management" /></div>
                </div>
            </div>
        </div>

        <!-- Buttons -->
        <div class="button-group">
            <button class="print-btn" onclick="window.print()">Print</button>
            <button class="clear-btn" onclick="clearForm()">Clear Form</button>
        </div>
    </div>

    <script>
        // Material options for each section
        const materialOptions = {
            panel: [
                'LP/PP( LIGHTING PANEL /POWER PANEL ):   Main:  1 - 60A, THREE PHASE, SE-EZC100H3060, 3P, 400V, 36 KAIC MCCB , SCHNEIDER, w/ Ground and neutral bus terminal. Branches: 17- 20AT/100AF, SE-EZC100N1020, 1P, 10KAIC, 240V, 60Hz, Bolt-on Type, SCHNEIDER Brand w/ Ground and Neutral busbar terminal. NEMA 1 ENCLOSURE',
                'PP( POWER PANEL ):   Main:  1 - 100A, THREE PHASE, SE-EZC100H3100, 3P, 400V, 36 KAIC MCCB , SCHNEIDER, w/ Ground and neutral bus terminal. Branches: 12- 20AT/100AF, SE-EZC100N1020, 1P, 10KAIC, 240V, 60Hz, Bolt-on Type, SCHNEIDER Brand w/ Ground and Neutral busbar terminal. NEMA 1 ENCLOSURE',
                'MDP( MAIN DISTRIBUTION PANEL ):   Main:  1 - 200A, THREE PHASE, SE-EZC100H3200, 3P, 400V, 65 KAIC MCCB , SCHNEIDER, w/ Ground and neutral bus terminal. Branches: 1- 100AT/100AF, SE-EZC100N3100, 3P, 10KAIC, 400V, 60Hz, Bolt-on Type, 1- 40AT/100AF, SE-EZC100N3040, 3P, 14KAIC, 400V, 60Hz, Bolt-on Type, SCHNEIDER Brand w/ Ground and Neutral busbar terminal. NEMA 1 ENCLOSURE',
                '2P-30A Circuit Breaker, GE Brand',
                '2P-20A Circuit Breaker, GE Brand',
                '1P-20A Circuit Breaker, GE Brand',
                '1P-15A Circuit Breaker, GE Brand',
                '3P-30A Circuit Breaker, GE Brand',
                '3P-20A Circuit Breaker, GE Brand',
                '1P-40A Circuit Breaker, GE Brand',
                '2P-40A Circuit Breaker, GE Brand',
                '3P-40A Circuit Breaker, GE Brand',
                '1P-50A Circuit Breaker, GE Brand',
                '2P-50A Circuit Breaker, GE Brand',
                '3P-50A Circuit Breaker, GE Brand',
                '1P-60A Circuit Breaker, GE Brand',
                '2P-60A Circuit Breaker, GE Brand',
                '3P-60A Circuit Breaker, GE Brand',
                '1P-15A Circuit Breaker, SE-EZC100N1015, Schneider Brand',
                '2P-15A Circuit Breaker, SE-EZC100N2015, Schneider Brand',
                '1P-20A Circuit Breaker, SE-EZC100N1020, Schneider Brand',
                '2P-20A Circuit Breaker, SE-EZC100N2020, Schneider Brand',
                '1P-30A Circuit Breaker, SE-EZC100N1030, Schneider Brand',
                '2P-30A Circuit Breaker, SE-EZC100N2030, Schneider Brand',
                '3P-30A Circuit Breaker, SE-EZC100N3030, Schneider Brand',
                '1P-40A Circuit Breaker, SE-EZC100N1040, Schneider Brand',
                '2P-40A Circuit Breaker, SE-EZC100N2040, Schneider Brand',
                '3P-40A Circuit Breaker, SE-EZC100N3040, Schneider Brand',
                '1P-50A Circuit Breaker, SE-EZC100N1050, Schneider Brand',
                '2P-50A Circuit Breaker, SE-EZC100N2050, Schneider Brand',
                '3P-50A Circuit Breaker, SE-EZC100N3050, Schneider Brand',
                '1P-60A Circuit Breaker, SE-EZC100N1060, Schneider Brand',
                '2P-60A Circuit Breaker, SE-EZC100N2060, Schneider Brand',
                '3P-60A Circuit Breaker, SE-EZC100N3060, Schneider Brand',
                '1P-75A Circuit Breaker, SE-EZC100N1075, Schneider Brand',
                '2P-75A Circuit Breaker, SE-EZC100N2075, Schneider Brand',
                '3P-75A Circuit Breaker, SE-EZC100N3075, Schneider Brand',
                '1P-100A Circuit Breaker, SE-EZC100N1100, Schneider Brand',
                '2P-100A Circuit Breaker, SE-EZC100N2100, Schneider Brand',
                '3P-100A Circuit Breaker, SE-EZC100N3100, Schneider Brand',
                '1P-125A Circuit Breaker, SE-EZC100N1125, Schneider Brand',
                '2P-125A Circuit Breaker, SE-EZC100N2125, Schneider Brand',
                '3P-125A Circuit Breaker, SE-EZC100N3125, Schneider Brand',
            ],
            wires: [
                'Royal Cable str. #14/3C',
                'Royal Cable str. #12/3C',
                '#22 AWG Str. cu. TF Wire -Red',
                '#22 AWG Str. cu. TF Wire -Yellow',
                '#22 AWG Str. cu. TF Wire -Blue',
                '#22 AWG Str. cu. TF Wire -Green',
                '#22 AWG Str. cu. TF Wire -Black',
                '#22 AWG Str. cu. TF Wire -White',
                '#18 AWG Str. cu. TF Wire -Red',
                '#18 AWG Str. cu. TF Wire -Yellow',
                '#18 AWG Str. cu. TF Wire -Blue',
                '#18 AWG Str. cu. TF Wire -Green',
                '#18 AWG Str. cu. TF Wire -Black',
                '#18 AWG Str. cu. TF Wire -White',
                '#16 AWG Str. cu. TF Wire -Red',
                '#16 AWG Str. cu. TF Wire -Yellow',
                '#16 AWG Str. cu. TF Wire -Blue',
                '#16 AWG Str. cu. TF Wire -Green',
                '#16 AWG Str. cu. TF Wire -Black',
                '#16 AWG Str. cu. TF Wire -White',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-Red',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-Yellow',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-Blue',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-Green',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-Black',
                '2.0 sq. mm. Str. cu. THHN, Phelps Dodge-White',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-Red',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-Yellow',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-Blue',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-Green',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-Black',
                '2.0 sq. mm. Solid cu. THHN, Phelps Dodge-White',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-Red',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-Yellow',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-Blue',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-Green',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-Black',
                '2.0 sq. mm. Str. Al. THHN, Phelps Dodge-White',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-Red',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-Yellow',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-Blue',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-Green',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-Black',
                '2.0 sq. mm. Solid Al. THHN, Phelps Dodge-White',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-Red',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-Yellow',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-Blue',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-Green',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-Black',
                '3.5 sq. mm. Str. cu. THHN, Phelps Dodge-White',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-Red',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-Yellow',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-Blue',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-Green',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-Black',
                '3.5 sq. mm. Solid cu. THHN, Phelps Dodge-White',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-Red',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-Yellow',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-Blue',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-Green',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-Black',
                '3.5 sq. mm. Str. Al. THHN, Phelps Dodge-White',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-Red',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-Yellow',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-Blue',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-Green',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-Black',
                '3.5 sq. mm. Solid Al. THHN, Phelps Dodge-White',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-Red',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-Yellow',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-Blue',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-Green',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-Black',
                '5.5 sq. mm. Str. cu. THHN, Phelps Dodge-White',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-Red',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-Yellow',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-Blue',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-Green',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-Black',
                '5.5 sq. mm. Solid cu. THHN, Phelps Dodge-White',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-Red',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-Yellow',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-Blue',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-Green',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-Black',
                '5.5 sq. mm. Str. Al. THHN, Phelps Dodge-White',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-Red',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-Yellow',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-Blue',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-Green',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-Black',
                '5.5 sq. mm. Solid Al. THHN, Phelps Dodge-White',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-Red',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-Yellow',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-Blue',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-Green',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-Black',
                '8.0 sq. mm. Str. cu.THHN, Phelps Dodge-White',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-Red',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-Yellow',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-Blue',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-Green',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-Black',
                '8.0 sq. mm. Solid cu.THHN, Phelps Dodge-White',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-Red',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-Yellow',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-Blue',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-Green',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-Black',
                '8.0 sq. mm. Str. Al.THHN, Phelps Dodge-White',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-Red',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-Yellow',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-Blue',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-Green',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-Black',
                '8.0 sq. mm. Solid Al.THHN, Phelps Dodge-White',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-Red',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-Yellow',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-Blue',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-Green',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-Black',
                '14.0 sq. mm. Str. cu.THHN, Phelps Dodge-White',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-Red',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-Yellow',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-Blue',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-Green',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-Black',
                '14.0 sq. mm. Solid cu.THHN, Phelps Dodge-White',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-Red',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-Yellow',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-Blue',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-Green',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-Black',
                '14.0 sq. mm. Str. Al.THHN, Phelps Dodge-White',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-Red',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-Yellow',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-Blue',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-Green',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-Black',
                '14.0 sq. mm. Solid Al.THHN, Phelps Dodge-White',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-Red',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-Yellow',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-Blue',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-Green',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-Black',
                '22.0 sq. mm. Str. cu.THHN, Phelps Dodge-White',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-Red',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-Yellow',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-Blue',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-Green',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-Black',
                '22.0 sq. mm. Solid cu.THHN, Phelps Dodge-White',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-Red',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-Yellow',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-Blue',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-Green',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-Black',
                '22.0 sq. mm. Str. Al.THHN, Phelps Dodge-White',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-Red',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-Yellow',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-Blue',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-Green',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-Black',
                '22.0 sq. mm. Solid Al.THHN, Phelps Dodge-White',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-Red',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-Yellow',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-Blue',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-Green',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-Black',
                '30.0 sq. mm. Str. cu.THHN, Phelps Dodge-White',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-Red',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-Yellow',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-Blue',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-Green',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-Black',
                '30.0 sq. mm. Solid cu.THHN, Phelps Dodge-White',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-Red',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-Yellow',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-Blue',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-Green',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-Black',
                '30.0 sq. mm. Str. Al.THHN, Phelps Dodge-White',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-Red',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-Yellow',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-Blue',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-Green',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-Black',
                '30.0 sq. mm. Solid Al.THHN, Phelps Dodge-White'
                
            ],
            lightingFixtures: [
                'LED BULB 9W, 3000K, 800 LUMENS, PANASONIC',
                'LED BULB 12W, 4000K, 1100 LUMENS, PANASONIC',
                'LED BULB 15W, 5000K, 1500 LUMENS, PANASONIC',
                'LED TUBE LIGHT 18W, 4000K, 1500 LUMENS, PANASONIC',
                'LED TUBE LIGHT 36W, 5000K, 3200 LUMENS, PANASONIC',
                'LED PANEL LIGHT 12W, 4000K, 900 LUMENS, PANASONIC',
                'LED PANEL LIGHT 18W, 5000K, 1400 LUMENS, PANASONIC',
                'LED FLOODLIGHT 30W, 5000K, 2400 LUMENS, PANASONIC',
                'LED STREETLIGHT 50W, 5000K, 4000 LUMENS, PANASONIC'
            ],
            outlets: [
                'GROUNDING DUPLEX UNIVERSAL OUTLET w/ safety shutter, 250V VAC, 15AMP, PANASONIC BRAND',
                'GROUNDING DUPLEX UNIVERSAL OUTLET w/ safety shutter 16A, 250V, WIDE SERIES, (WEG 15829) PANASONIC Brand',
                'GROUNDING DUPLEX UNIVERSAL OUTLET w/ safety shutter, 250V VAC, 20AMP, PANASONIC BRAND',
                'SINGLE CONVENIENCE OUTLET, 250V VAC, 15AMP, PANASONIC BRAND',
                'SINGLE CONVENIENCE OUTLET, 250V VAC, 20AMP, PANASONIC BRAND',
                '1 GANG SWITCH, PANASONIC BRAND',
                '2 GANG SWITCH, PANASONIC BRAND',
                '3 GANG SWITCH, PANASONIC BRAND',
                'Floor Outlet grounding type, 2 GANG WITH Plate with Cover, 4" x 4", ABSO BRAND',
                'DATA OUTLET, CAT6, PANASONIC BRAND',
                'TELEPHONE OUTLET, PANASONIC BRAND'
            ],

            conduit: [
                '15mm PVC Pipe, 3 meters',
                '20mm PVC Pipe, 3 meters',
                '25mm PVC Pipe, 3 meters',
                '15mm diam EMT Pipe, 3 meters',
                '15mm diam. EMT Connector-Compression Type',
                '15mm diam. EMT Coupling-Compression Type',
                '15mm diam. bushing with locknut',
                '15mm diam. U-Bolt with Locknut and washer',
                '20mm diam EMT Pipe, 3 meters',
                '20mm diam. EMT Connector-Compression Type',
                '20mm diam. EMT Coupling-Compression Type',
                '20mm diam. bushing with locknut',
                '20mm diam. U-Bolt with Locknut and washer',
                '25mm diam EMT Pipe, 3 meters',
                '25mm diam. EMT Connector-Compression Type',
                '25mm diam. EMT Coupling-Compression Type',
                '25mm diam. bushing with locknut',
                '32mm diam EMT Pipe, 3 meters',
                '32mm diam. EMT Connector-Compression Type',
                '32mm diam. EMT Coupling-Compression Type',
                '32mm diam. bushing with locknut',
                '40mm diam EMT Pipe, 3 meters',
                '40mm diam. EMT Connector-Compression Type',
                '40mm diam. EMT Coupling-Compression Type',
                '40mm diam. bushing with locknut',
                '50mm diam EMT Pipe, 3 meters',
                '50mm diam. EMT Connector-Compression Type',
                '50mm diam. EMT Coupling-Compression Type',
                '50mm diam. bushing with locknut',
                '15mm diam. RSC Pipe, 3 meters',
                '15mm diam. RSC Coupling-Set Screw Type',
                '15mm diam. RSC Connector-Set Screw Type',
                '15mm diam. RSC Pipe Bushing and locknut',
                '20mm diam. RSC Pipe, 3 meters',
                '20mm diam. RSC Coupling-Set Screw Type',
                '20mm diam. RSC Connector-Set Screw Type',
                '20mm diam. RSC Pipe Bushing and locknut',
                '25mm diam. RSC Pipe, 3 meters',
                '25mm diam. RSC Coupling-Set Screw Type',
                '25mm diam. RSC Connector-Set Screw Type',
                '25mm diam. RSC Pipe Bushing and locknut',
                '32mm diam. RSC Pipe, 3 meters',
                '32mm diam. RSC Coupling-Set Screw Type',
                '32mm diam. RSC Connector-Set Screw Type',
                '32mm diam. RSC Pipe Bushing and locknut',
                '40mm diam. RSC Pipe, 3 meters',
                '40mm diam. RSC Coupling-Set Screw Type',
                '40mm diam. RSC Connector-Set Screw Type',
                '40mm diam. RSC Pipe Bushing and locknut',
                '50mm diam. RSC Pipe, 3 meters',
                '50mm diam. RSC Coupling-Set Screw Type',
                '50mm diam. RSC Connector-Set Screw Type',
                '50mm diam. RSC Pipe Bushing and locknut',
                'Flexible Metallic conduit 3/8"',
                'Flexible Metallic conduit 1/2"',
                'Flexible Metallic connector 3/8"',
                'Flexible Metallic connector 1/2"',

            ],


            misc: [
                'Electrical Tape',
                'Rubber Molding',
                'Duct Tape',
                'Warning Tape',
                'Cloth Tape',
                'Flexible Metallic conduit 3/8"',
                'Flexible Metallic conduit 1/2"',
                'Flexible Metallic connector 3/8"',
                'Flexible Metallic connector 1/2"',
                'Electrical Fixtures',
                'Cable Ties',
                'Conduit Pipe 1/2"',
                'Conduit Pipe 3/4"'
            ]
        };

        // Function to show dropdown
        function showMaterialDropdown(input) {
            // Remove any existing dropdowns
            document.querySelectorAll('.material-dropdown').forEach(el => el.remove());

            const section = input.getAttribute('data-section');
            const options = materialOptions[section] || [];

            const dropdown = document.createElement('div');
            dropdown.className = 'material-dropdown';

            const rect = input.getBoundingClientRect();
            dropdown.style.position = 'absolute';
            dropdown.style.left = rect.left + window.scrollX + 'px';
            dropdown.style.top = rect.bottom + window.scrollY + 'px';
            dropdown.style.width = rect.width + 'px';

            options.forEach(option => {
                const item = document.createElement('div');
                item.textContent = option;
                item.addEventListener('click', function() {
                    input.value = option;
                    dropdown.remove();
                    autoResizeTextarea(input);
                });
                dropdown.appendChild(item);
            });

            document.body.appendChild(dropdown);
        }

        // Function to auto-resize textarea based on content
        function autoResizeTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        // Attach click listeners to description inputs
        function attachDescriptionListeners() {
            document.querySelectorAll('.description-input').forEach(input => {
                input.addEventListener('click', function(e) {
                    e.stopPropagation();
                    showMaterialDropdown(this);
                });
                input.addEventListener('focus', function(e) {
                    showMaterialDropdown(this);
                });
                input.addEventListener('input', function() {
                    autoResizeTextarea(this);
                });
                // Initial resize
                autoResizeTextarea(input);
            });
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.description-input') && !e.target.closest('.material-dropdown')) {
                document.querySelectorAll('.material-dropdown').forEach(el => el.remove());
            }
            if (!e.target.closest('.unit-input') && !e.target.closest('.unit-dropdown')) {
                document.querySelectorAll('.unit-dropdown').forEach(el => el.remove());
            }
        });

        // Unit options for dropdown
        const unitOptions = ['pcs', 'pc', 'set', 'sets', 'gal', 'roll', 'assy', 'kgs', 'liter', 'box'];

        // Function to show unit dropdown
        function showUnitDropdown(input) {
            // Remove any existing dropdowns
            document.querySelectorAll('.unit-dropdown').forEach(el => el.remove());

            const dropdown = document.createElement('div');
            dropdown.className = 'unit-dropdown';

            const rect = input.getBoundingClientRect();
            dropdown.style.position = 'absolute';
            dropdown.style.left = rect.left + window.scrollX + 'px';
            dropdown.style.top = rect.bottom + window.scrollY + 'px';
            dropdown.style.width = rect.width + 'px';

            unitOptions.forEach(option => {
                const item = document.createElement('div');
                item.textContent = option;
                item.addEventListener('click', function() {
                    input.value = option;
                    dropdown.remove();
                });
                dropdown.appendChild(item);
            });

            document.body.appendChild(dropdown);
        }

        // Attach click listeners to unit inputs
        function attachUnitListeners() {
            document.querySelectorAll('.unit-input').forEach(input => {
                input.addEventListener('click', function(e) {
                    e.stopPropagation();
                    showUnitDropdown(this);
                });
                input.addEventListener('focus', function(e) {
                    showUnitDropdown(this);
                });
            });
        }

        // Function to parse number from string (handles commas)
        function parseNumber(str) {
            if (!str) return 0;
            return parseFloat(str.toString().replace(/,/g, '')) || 0;
        }

        // Function to format number with commas and 2 decimal places
        function formatNumber(num) {
            return num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // Function to calculate row total (QTY * UNIT COST)
        function calculateRowTotal(row) {
            const qtyInput = row.querySelector('.qty-input');
            const unitCostInput = row.querySelector('.unit-cost-input');
            const totalCostCell = row.querySelector('.total-cost');

            if (qtyInput && unitCostInput && totalCostCell) {
                const qty = parseNumber(qtyInput.value);
                const unitCost = parseNumber(unitCostInput.value);
                const total = qty * unitCost;
                totalCostCell.textContent = formatNumber(total);
            }
        }

        // Function to calculate grand total (sum of all TOTAL COST)
        function calculateGrandTotal() {
            let grandTotal = 0;
            document.querySelectorAll('.total-cost').forEach(cell => {
                grandTotal += parseNumber(cell.textContent);
            });
            document.getElementById('grandTotal').textContent = formatNumber(grandTotal);
        }

        // Function to recalculate all totals
        function recalculateAllTotals() {
            document.querySelectorAll('#panelTable tbody tr, #wiresTable tbody tr, #outletsTable tbody tr, #miscTable tbody tr').forEach(row => {
                calculateRowTotal(row);
            });
            calculateGrandTotal();
        }

        // Attach listeners to qty and unit cost inputs for calculation
        function attachCalculationListeners() {
            document.querySelectorAll('.qty-input, .unit-cost-input').forEach(input => {
                input.addEventListener('input', function() {
                    const row = this.closest('tr');
                    calculateRowTotal(row);
                    calculateGrandTotal();
                });
                input.addEventListener('change', function() {
                    const row = this.closest('tr');
                    calculateRowTotal(row);
                    calculateGrandTotal();
                });
            });
        }

        // Function to get section from table ID
        function getSectionFromTableId(tableId) {
            if (tableId === 'panelTable') return 'panel';
            if (tableId === 'wiresTable') return 'wires';
            if (tableId === 'lightingFixturesTable') return 'lightingFixtures';
            if (tableId === 'outletsTable') return 'outlets';
            if (tableId === 'conduitTable') return 'conduit';
            if (tableId === 'miscTable') return 'misc';
            return 'misc';
        }

        // Function to add a new row to a table
        function addRow(tableId) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const newRow = tbody.rows[0].cloneNode(true);
            const section = getSectionFromTableId(tableId);

            // Clear description textarea
            const descInput = newRow.querySelector('.description-input');
            if (descInput) {
                descInput.value = '';
                descInput.textContent = '';
                descInput.setAttribute('data-section', section);
                descInput.style.height = 'auto';
            }

            // Clear unit input
            const unitInput = newRow.querySelector('.unit-input');
            if (unitInput) {
                unitInput.value = '';
            }

            // Clear qty input
            const qtyInput = newRow.querySelector('.qty-input');
            if (qtyInput) {
                qtyInput.value = '';
            }

            // Clear unit cost input
            const unitCostInput = newRow.querySelector('.unit-cost-input');
            if (unitCostInput) {
                unitCostInput.value = '';
            }

            // Clear total cost cell
            const cells = newRow.querySelectorAll('td');
            if (cells.length > 4) {
                cells[4].textContent = '';
            }

            tbody.appendChild(newRow);
            attachDescriptionListeners();
            attachUnitListeners();
            attachCalculationListeners();
            calculateGrandTotal();
        }

        // Function to remove the last row from a table
        function removeLastRow(tableId) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const rows = tbody.querySelectorAll('tr');

            // Keep at least one row
            if (rows.length > 1) {
                rows[rows.length - 1].remove();
                calculateGrandTotal();
            } else {
                alert('You must keep at least one row in this section.');
            }
        }

        // Function to delete an entire section
        function deleteSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                if (confirm('Are you sure you want to delete this entire section?')) {
                    section.remove();
                    calculateGrandTotal();
                }
            }
        }

        // Section templates for adding new sections
        const sectionTypeTemplates = {
            panel: {
                id: 'panelSection',
                tableId: 'panelTable',
                title: 'PANEL BOARD AND CIRCUIT BREAKERS:',
                dataSection: 'panel'
            },
            wires: {
                id: 'wiresSection',
                tableId: 'wiresTable',
                title: 'WIRES AND CABLES:',
                dataSection: 'wires'
            },
            lighting: {
                id: 'lightingSection',
                tableId: 'lightingFixturesTable',
                title: 'LIGHTING FIXTURES:',
                dataSection: 'lightingFixtures'
            },
            outlets: {
                id: 'outletsSection',
                tableId: 'outletsTable',
                title: 'CONVENIENCE OUTLET AND SWITCHES:',
                dataSection: 'outlets'
            },
            conduit: {
                id: 'conduitSection',
                tableId: 'conduitTable',
                title: 'CONDUIT AND FITTINGS:',
                dataSection: 'conduit'
            },
            misc: {
                id: 'miscSection',
                tableId: 'miscTable',
                title: 'MISCELLANEOUS:',
                dataSection: 'misc'
            }
        };

        // Counter for unique IDs
        let sectionCounter = 1;

        // Function to toggle the section dropdown menu
        function toggleSectionDropdown(button) {
            // Close all other dropdowns first
            document.querySelectorAll('.section-dropdown').forEach(dropdown => {
                if (dropdown !== button.nextElementSibling) {
                    dropdown.classList.remove('show');
                }
            });
            
            // Toggle the current dropdown
            const dropdown = button.nextElementSibling;
            dropdown.classList.toggle('show');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.matches('.add-section-btn') && !event.target.matches('.section-dropdown-item')) {
                document.querySelectorAll('.section-dropdown').forEach(dropdown => {
                    dropdown.classList.remove('show');
                });
            }
        });

        // Function to add a section by type (called from dropdown)
        function addSectionByType(afterSectionId, sectionType) {
            const template = sectionTypeTemplates[sectionType];
            if (!template) return;

            // Close the dropdown
            document.querySelectorAll('.section-dropdown').forEach(dropdown => {
                dropdown.classList.remove('show');
            });

            const afterSection = document.getElementById(afterSectionId);
            if (!afterSection) {
                // If section was deleted, find the total row and insert before it
                const totalRow = document.querySelector('.total-row').closest('table');
                if (totalRow) {
                    const newSection = createSectionHTML(template);
                    totalRow.insertAdjacentHTML('beforebegin', newSection);
                    reattachAllListeners();
                    calculateGrandTotal();
                }
                return;
            }

            const newSection = createSectionHTML(template);
            afterSection.insertAdjacentHTML('afterend', newSection);
            reattachAllListeners();
            calculateGrandTotal();
        }

        // Function to create section HTML
        function createSectionHTML(template) {
            sectionCounter++;
            const newId = template.id + '_' + sectionCounter;
            const newTableId = template.tableId + '_' + sectionCounter;

            return `
        <div id="${newId}" class="bom-section">
        <div class="section-title">${template.title}</div>
        <table id="${newTableId}">
            <thead>
                <tr>
                    <th style="width: 45%;">ITEM DESCRIPTION</th>
                    <th style="width: 10%;">UNIT</th>
                    <th style="width: 10%;">QTY</th>
                    <th style="width: 17%;">UNIT COST</th>
                    <th style="width: 18%;">TOTAL COST</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="description-input" data-section="${template.dataSection}" rows="1"></textarea></td>
                    <td><input type="text" class="unit-input" value=""></td>
                    <td><input type="number" class="qty-input" value=""></td>
                    <td><input type="text" class="unit-cost-input" value=""></td>
                    <td class="text-right total-cost">0.00</td>
                </tr>
            </tbody>
        </table>
        <div>
            <button class="add-row-btn" onclick="addRow('${newTableId}')">+ Add Row</button>
            <button class="remove-row-btn" onclick="removeLastRow('${newTableId}')">- Remove Row</button>
            <button class="delete-section-btn" onclick="deleteSection('${newId}')">Delete Section</button>
            <span class="section-btn-container">
                <button class="add-section-btn" onclick="toggleSectionDropdown(this)">+ Add Section</button>
                <div class="section-dropdown">
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'panel')">PANEL BOARD AND CIRCUIT BREAKERS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'wires')">WIRES AND CABLES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'lighting')">LIGHTING FIXTURES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'outlets')">CONVENIENCE OUTLET AND SWITCHES</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'conduit')">CONDUIT AND FITTINGS</div>
                    <div class="section-dropdown-item" onclick="addSectionByType('${newId}', 'misc')">MISCELLANEOUS</div>
                </div>
            </span>
        </div>
        </div>
            `;
        }

        // Function to reattach all listeners after adding new sections
        function reattachAllListeners() {
            attachDescriptionListeners();
            attachUnitListeners();
            attachCalculationListeners();
        }

        // Function to clear the form
        function clearForm() {
            if (confirm('Are you sure you want to clear the form? All data will be lost.')) {
                // Clear all text inputs
                document.querySelectorAll('input[type="text"]').forEach(input => {
                    input.value = '';
                });
                
                // Clear all number inputs
                document.querySelectorAll('input[type="number"]').forEach(input => {
                    input.value = '';
                });
                
                // Clear all textareas (description inputs)
                document.querySelectorAll('textarea').forEach(textarea => {
                    textarea.value = '';
                    textarea.style.height = 'auto';
                });
                
                // Reset all total-cost cells to 0.00
                document.querySelectorAll('.total-cost').forEach(cell => {
                    cell.textContent = '0.00';
                });
                
                // Reset grand total
                document.getElementById('grandTotal').textContent = '0.00';
                
                // Regenerate reference number
                generateReferenceNo();
            }
        }

        // Initialize listeners on page load
        window.addEventListener('DOMContentLoaded', function() {
            attachDescriptionListeners();
            attachUnitListeners();
            attachCalculationListeners();
            recalculateAllTotals();
        });
    </script>
</body>
</html>
